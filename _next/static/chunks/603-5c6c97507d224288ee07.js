(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[603],{2137:function(e,t,n){"use strict";function i(e,t,n,i,r,o,s){try{var c=e[o](s),a=c.value}catch(l){return void n(l)}c.done?t(a):Promise.resolve(a).then(i,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var s=e.apply(t,n);function c(e){i(s,r,o,c,a,"next",e)}function a(e){i(s,r,o,c,a,"throw",e)}c(void 0)}))}}n.d(t,{Z:function(){return r}})},18:function(e,t,n){"use strict";function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.d(t,{Z:function(){return r}})},9835:function(e,t,n){"use strict";n.d(t,{Z:function(){return k}});var i=n(5893),r=n(7294),o=n(9008),s=n(155);function c(e){var t=e.sidebarLabel;return(0,i.jsxs)("div",{className:"navbar w-full mb-4 px-0 lg:px-4 shadow-lg bg-base-100 text-base-content rounded-box shadow-lg",children:[(0,i.jsx)("div",{className:"flex-none flex lg:hidden drawer-button",children:(0,i.jsx)("label",{htmlFor:t,className:"btn btn-square btn-ghost",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"inline-block w-6 h-6 stroke-current",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})})}),(0,i.jsxs)("div",{className:"navbar-center flex-1 mx-1 invisible sm:visible",children:[(0,i.jsx)("img",{src:"/kokoa-dashboard/kokoa-logo.png",alt:"kokoa",className:"h-10 w-10 mr-2"}),(0,i.jsx)("span",{className:"text-lg font-bold",children:"Kokoa"})]}),(0,i.jsx)("div",{className:"flex-none ",children:(0,i.jsx)("button",{className:"btn btn-square btn-ghost",children:(0,i.jsx)(s.bI9,{className:"inline-block w-6 h-6 stroke-current"})})}),(0,i.jsx)("div",{className:"flex-none",children:(0,i.jsx)("div",{className:"avatar",children:(0,i.jsx)("div",{className:"rounded-full w-10 h-10 m-1",children:(0,i.jsx)("img",{src:"/kokoa-dashboard/avatar.png"})})})})]})}var a=n(6156),l=n(7375),u=n(1163),h=n(1664);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e){var t=e.href,n=e.exact,r=e.children,o=(0,l.Z)(e,["href","exact","children"]),s=(0,u.useRouter)().pathname;return(n?s===t:s.startsWith(t))&&(o.className+=" active"),(0,i.jsx)(h.default,{href:t,as:"/kokoa-dashboard"+t,children:(0,i.jsx)("a",d(d({},o),{},{children:r}))})}v.defaultProps={exact:!1};var m=n(8193),p=n(2585),b=n(7735),w=n(9598);function g(){var e=(0,r.useContext)(w.g).skelefire;return(0,i.jsxs)("ul",{className:"menu p-4 overflow-y-auto w-80 bg-base-100 rounded-box shadow-lg",children:[(0,i.jsx)("li",{children:(0,i.jsxs)(v,{href:"/",exact:!0,children:[(0,i.jsx)(m.V9Z,{className:"w-6 h-6 mr-2"})," Dashboard"]})}),(0,i.jsx)("li",{children:(0,i.jsxs)(v,{href:"/settings",exact:!0,children:[(0,i.jsx)(m.xRF,{className:"w-6 h-6 mr-2"})," Settings"]})}),(0,i.jsx)("li",{className:"menu-title mt-4 mb-1",children:(0,i.jsx)("span",{children:"Notifiers"})}),(0,i.jsx)("li",{children:(0,i.jsxs)(v,{href:"/skelefire",exact:!0,children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(p.qVT,{className:"w-6 h-6 mr-2"})," Skelefire"]}),e.activities.length>0&&(0,i.jsx)("div",{className:"ml-auto badge border-none badge-accent bg-neutral-content",children:e.activities.length})]})}),(0,i.jsx)("li",{children:(0,i.jsxs)(v,{href:"/strawberry",exact:!0,children:[(0,i.jsx)(p.CLk,{className:"w-6 h-6 mr-2"})," Strawberry"]})}),(0,i.jsx)("li",{children:(0,i.jsxs)(v,{href:"/matcha",exact:!0,children:[(0,i.jsx)(b.Xkc,{className:"w-6 h-6 mr-2"})," Matcha"]})}),(0,i.jsx)("li",{className:"menu-title mt-4 mb-1",children:(0,i.jsx)("span",{children:"Apps"})}),(0,i.jsx)("li",{children:(0,i.jsxs)(v,{href:"/tiramisu",exact:!0,children:[(0,i.jsx)(p.Omh,{className:"w-6 h-6 mr-2"}),"Tiramisu"]})})]})}var x=n(8279);function k(e){var t=e.children,n=e.labelName;return(0,i.jsxs)("div",{children:[(0,i.jsxs)(o.default,{children:[(0,i.jsx)("title",{children:"Kokoa"}),(0,i.jsx)("link",{rel:"icon",href:"/kokoa-dashboard/kokoa-favicon.png"})]}),(0,i.jsxs)("div",{className:"flex flex-col items-center w-full min-h-screen h-screen bg-neutral",children:[(0,i.jsxs)("div",{className:"w-full flex-1 drawer drawer-mobile px-4 md:px-8 pt-4 md:pt-8",children:[(0,i.jsx)("input",{id:n,type:"checkbox",className:"drawer-toggle"}),(0,i.jsxs)("div",{className:"drawer-content flex flex-col items-center pl-0 md:pl-6 scrollbar scrollbar-hidden",children:[(0,i.jsx)(c,{sidebarLabel:n}),(0,i.jsx)("main",{className:"flex w-full flex-1 items-start",children:t})]}),(0,i.jsxs)("div",{className:"drawer-side",children:[(0,i.jsx)("label",{htmlFor:n,className:"drawer-overlay"}),(0,i.jsx)(g,{})]})]}),(0,i.jsx)(x.x7,{position:"bottom-right",toastOptions:{success:{className:"alert alert-success"},error:{style:{background:"red"}}}}),(0,i.jsx)("footer",{className:"flex items-center justify-center w-full h-8 ",children:"\xa9 Caramel Lyth"})]})]})}},2713:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var i=n(7757),r=n.n(i),o=n(5893),s=n(2137),c=n(7294),a=n(4407),l=n(9598),u=n(2585),h=n(8874),f=n.n(h);function d(){var e=(0,c.useState)(!1),t=e[0],n=e[1],i=(0,c.useContext)(l.g),h=i.skelefire,d=i.setActivities,v=i.countUnreadActivities,m=i.markAsRead;function p(){return(p=(0,s.Z)(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(!0),e.next=3,(0,a.ir)();case 3:return e.next=5,(0,a.az)();case 5:t=e.sent,d(t.data),v(),n(!1),t.data.length>0&&f().create("Skelefire",{body:"New updates found!",icon:"/kokoa-dashboard/kokoa-skelefire.png",onClick:function(){window.focus(),this.close()}});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,o.jsxs)("div",{className:"card-title flex justify-between",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(u.qVT,{className:"w-6 h-6 mr-2"})," Skelefire"]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"dropdown dropdown-end dropdown-hover",children:[(0,o.jsx)("div",{tabIndex:"0",className:"m-1 btn btn-sm btn-ghost",children:"Actions"}),(0,o.jsxs)("ul",{className:"shadow menu dropdown-content bg-primary text-primary-content rounded-box w-52 text-base",children:[(0,o.jsx)("li",{children:(0,o.jsx)("a",{onClick:function(){var e=h.activities.filter((function(e){return e.selected})).map((function(e){return e.moduleID}));m(e)},children:"Mark selected as read"})}),(0,o.jsx)("li",{children:(0,o.jsx)("a",{onClick:function(){var e=h.activities.map((function(e){return e.moduleID}));m(e)},children:"Mark all as read"})})]})]}),(0,o.jsx)("button",{onClick:function(){return p.apply(this,arguments)},className:"btn btn-sm btn-ghost ".concat(t&&"loading"),children:t?"loading":"refresh"})]})]})}},2562:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var i=n(5893),r=n(6156),o=n(7294),s=n(9598),c=n(381),a=n.n(c),l=n(4578);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e){var t=e.activity,n=e.isOverview,r=(0,o.useContext)(s.g),c=r.skelefire,u=r.markAsRead,f=r.setActivities;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)("input",{type:"checkbox",checked:t.selected,onClick:function(){f(c.activities.map((function(e){return e.moduleID==t.moduleID?h(h({},e),{},{selected:!e.selected}):e})))},readOnly:!0,className:"checkbox checkbox-sm"})}),(0,i.jsx)("td",{children:(0,i.jsx)("a",{href:"https://scele.cs.ui.ac.id/course/view.php?id=".concat(t.course),target:"_blank",className:"badge badge-accent",children:function(e){var t=c.courses.find((function(t){return t.courseID===e}));return null===t||void 0===t?void 0:t.shortname}(t.course)})}),(0,i.jsx)("td",{className:"".concat(n?"max-w-snippet":"max-w-prose"," truncate text-left"),children:t.content}),(0,i.jsx)("td",{children:a()(t.lastUpdated).fromNow()}),(0,i.jsx)("td",{children:(0,i.jsx)("button",{onClick:function(){return e=t.moduleID,u([e]);var e},className:"btn btn-sm btn-ghost",children:(0,i.jsx)(l.J$L,{})})})]})}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e){var t=e.activities,n=e.isOverview,r=(0,o.useContext)(s.g),c=r.skelefire,a=r.setActivities,l=(0,o.useState)(c.activities.every((function(e){return e.selected}))),u=l[0],h=l[1];return(0,i.jsxs)("div",{className:"".concat(n?"max-h-56":"max-h-80"," overflow-auto scrollbar scrollbar-hidden hover:scrollbar-width-1 hover:scrollbar-track-transparent hover:scrollbar-thumb-yellow-600 hover:scrollbar-track-radius-full pr-1.5"),children:[(0,i.jsxs)("table",{className:"table table-compact w-full text-center relative",children:[(0,i.jsx)("thead",{className:"sticky top-0 z-20",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:(0,i.jsx)("input",{type:"checkbox",checked:c.activities.every((function(e){return e.selected})),onClick:function(){h(!u),a(c.activities.map((function(e){return v(v({},e),{},{selected:u})})))},readOnly:!0,className:"checkbox checkbox-sm"})}),(0,i.jsx)("th",{children:"Course"}),(0,i.jsx)("th",{className:"text-left",children:"Activity Name"}),(0,i.jsx)("th",{children:"Last Update"}),(0,i.jsx)("th",{})]})}),0!=t.length&&(0,i.jsx)("tbody",{children:t.map((function(e){return(0,i.jsx)(f,{activity:e,isOverview:n},e.moduleID)}))})]}),0==t.length&&(0,i.jsx)("div",{className:"w-full pt-6 flex justify-center",children:(0,i.jsx)("img",{src:"/kokoa-dashboard/empty-inbox.svg",alt:"empty",className:n?"h-48":"h-60"})})]})}},4168:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var i=n(5893),r=n(7294),o=n(9598);function s(){var e=(0,r.useContext)(o.g).skelefire;return(0,i.jsx)("div",{className:"grid grid-cols-2 grid-rows-3 md:grid-cols-6 md:grid-rows-none gap-4",children:e.courses.map((function(e){return(0,i.jsx)("a",{href:"https://scele.cs.ui.ac.id/course/view.php?id=".concat(e.courseID),target:"_blank",className:"btn bg-accent text-accent-content rounded-box",children:e.shortname},e.courseID)}))})}},1486:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var i=n(5893);n(7294);function r(e){var t=e.coursesTabs,n=e.activeTab,r=e.onTabChange;return(0,i.jsxs)("div",{className:"tabs",children:[t.map((function(e){return(0,i.jsxs)("div",{onClick:function(){return r(e.shortname)},className:"indicator tab tab-lifted ".concat(e.shortname===n&&"tab-active"),children:[e.shortname,e.unread>0&&(0,i.jsx)("div",{className:"badge ml-2 ".concat(e.shortname===n&&"badge-outline"),children:e.unread})]},e.shortname)})),(0,i.jsx)("div",{className:"flex-1 tab tab-lifted cursor-default"})]})}},8874:function(e,t,n){e.exports=function(){"use strict";var e={errors:{incompatible:"".concat("PushError:"," Push.js is incompatible with browser."),invalid_plugin:"".concat("PushError:"," plugin class missing from plugin manifest (invalid plugin). Please check the documentation."),invalid_title:"".concat("PushError:"," title of notification must be a string"),permission_denied:"".concat("PushError:"," permission request declined"),sw_notification_error:"".concat("PushError:"," could not show a ServiceWorker notification due to the following reason: "),sw_registration_error:"".concat("PushError:"," could not register the ServiceWorker due to the following reason: "),unknown_interface:"".concat("PushError:"," unable to create notification: unknown interface")}};function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var u=function(){function e(t){i(this,e),this._win=t,this.GRANTED="granted",this.DEFAULT="default",this.DENIED="denied",this._permissions=[this.GRANTED,this.DEFAULT,this.DENIED]}return o(e,[{key:"request",value:function(e,t){return arguments.length>0?this._requestWithCallback.apply(this,arguments):this._requestAsPromise()}},{key:"_requestWithCallback",value:function(e,t){var n,i=this,r=this.get(),o=!1,s=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i._win.Notification.permission;o||(o=!0,void 0===n&&i._win.webkitNotifications&&(n=i._win.webkitNotifications.checkPermission()),n===i.GRANTED||0===n?e&&e():t&&t())};r!==this.DEFAULT?s(r):this._win.webkitNotifications&&this._win.webkitNotifications.checkPermission?this._win.webkitNotifications.requestPermission(s):this._win.Notification&&this._win.Notification.requestPermission?(n=this._win.Notification.requestPermission(s))&&n.then&&n.then(s).catch((function(){t&&t()})):e&&e()}},{key:"_requestAsPromise",value:function(){var e=this,t=this.get(),n=t!==this.DEFAULT,i=this._win.Notification&&this._win.Notification.requestPermission,r=this._win.webkitNotifications&&this._win.webkitNotifications.checkPermission;return new Promise((function(o,s){var c,a=!1,l=function(t){a||(a=!0,function(t){return t===e.GRANTED||0===t}(t)?o():s())};n?l(t):r?e._win.webkitNotifications.requestPermission((function(e){l(e)})):i?(c=e._win.Notification.requestPermission(l))&&c.then&&c.then(l).catch(s):o()}))}},{key:"has",value:function(){return this.get()===this.GRANTED}},{key:"get",value:function(){return this._win.Notification&&this._win.Notification.permission?this._win.Notification.permission:this._win.webkitNotifications&&this._win.webkitNotifications.checkPermission?this._permissions[this._win.webkitNotifications.checkPermission()]:navigator.mozNotification?this.GRANTED:this._win.external&&this._win.external.msIsSiteMode?this._win.external.msIsSiteMode()?this.GRANTED:this.DEFAULT:this.GRANTED}}]),e}(),h=function(){function e(){i(this,e)}return o(e,null,[{key:"isUndefined",value:function(e){return void 0===e}},{key:"isNull",value:function(e){return null===obj}},{key:"isString",value:function(e){return"string"==typeof e}},{key:"isFunction",value:function(e){return e&&"[object Function]"==={}.toString.call(e)}},{key:"isObject",value:function(e){return"object"===t(e)}},{key:"objectMerge",value:function(e,t){for(var n in t)e.hasOwnProperty(n)&&this.isObject(e[n])&&this.isObject(t[n])?this.objectMerge(e[n],t[n]):e[n]=t[n]}}]),e}(),f=function e(t){i(this,e),this._win=t},d=function(e){function t(){return i(this,t),l(this,c(t).apply(this,arguments))}return s(t,f),o(t,[{key:"isSupported",value:function(){return void 0!==this._win.Notification}},{key:"create",value:function(e,t){return new this._win.Notification(e,{icon:h.isString(t.icon)||h.isUndefined(t.icon)||h.isNull(t.icon)?t.icon:t.icon.x32,body:t.body,tag:t.tag,requireInteraction:t.requireInteraction})}},{key:"close",value:function(e){e.close()}}]),t}(),v=function(t){function n(){return i(this,n),l(this,c(n).apply(this,arguments))}return s(n,f),o(n,[{key:"isSupported",value:function(){return void 0!==this._win.navigator&&void 0!==this._win.navigator.serviceWorker}},{key:"getFunctionBody",value:function(e){var t=e.toString().match(/function[^{]+{([\s\S]*)}$/);return null!=t&&t.length>1?t[1]:null}},{key:"create",value:function(t,n,i,r,o){var s=this;this._win.navigator.serviceWorker.register(r),this._win.navigator.serviceWorker.ready.then((function(r){var c={id:t,link:i.link,origin:document.location.href,onClick:h.isFunction(i.onClick)?s.getFunctionBody(i.onClick):"",onClose:h.isFunction(i.onClose)?s.getFunctionBody(i.onClose):""};void 0!==i.data&&null!==i.data&&(c=Object.assign(c,i.data)),r.showNotification(n,{icon:i.icon,body:i.body,vibrate:i.vibrate,tag:i.tag,data:c,requireInteraction:i.requireInteraction,silent:i.silent}).then((function(){r.getNotifications().then((function(e){r.active.postMessage(""),o(e)}))})).catch((function(t){throw new Error(e.errors.sw_notification_error+t.message)}))})).catch((function(t){throw new Error(e.errors.sw_registration_error+t.message)}))}},{key:"close",value:function(){}}]),n}(),m=function(e){function t(){return i(this,t),l(this,c(t).apply(this,arguments))}return s(t,f),o(t,[{key:"isSupported",value:function(){return void 0!==this._win.navigator.mozNotification}},{key:"create",value:function(e,t){var n=this._win.navigator.mozNotification.createNotification(e,t.body,t.icon);return n.show(),n}}]),t}(),p=function(e){function t(){return i(this,t),l(this,c(t).apply(this,arguments))}return s(t,f),o(t,[{key:"isSupported",value:function(){return void 0!==this._win.external&&void 0!==this._win.external.msIsSiteMode}},{key:"create",value:function(e,t){return this._win.external.msSiteModeClearIconOverlay(),this._win.external.msSiteModeSetIconOverlay(h.isString(t.icon)||h.isUndefined(t.icon)?t.icon:t.icon.x16,e),this._win.external.msSiteModeActivate(),null}},{key:"close",value:function(){this._win.external.msSiteModeClearIconOverlay()}}]),t}(),b=function(e){function t(){return i(this,t),l(this,c(t).apply(this,arguments))}return s(t,f),o(t,[{key:"isSupported",value:function(){return void 0!==this._win.webkitNotifications}},{key:"create",value:function(e,t){var n=this._win.webkitNotifications.createNotification(t.icon,e,t.body);return n.show(),n}},{key:"close",value:function(e){e.cancel()}}]),t}();return new(function(){function t(e){i(this,t),this._currentId=0,this._notifications={},this._win=e,this.Permission=new u(e),this._agents={desktop:new d(e),chrome:new v(e),firefox:new m(e),ms:new p(e),webkit:new b(e)},this._configuration={serviceWorker:"/serviceWorker.min.js",fallback:function(e){}}}return o(t,[{key:"_closeNotification",value:function(t){var n=!0,i=this._notifications[t];if(void 0!==i){if(n=this._removeNotification(t),this._agents.desktop.isSupported())this._agents.desktop.close(i);else if(this._agents.webkit.isSupported())this._agents.webkit.close(i);else{if(!this._agents.ms.isSupported())throw n=!1,new Error(e.errors.unknown_interface);this._agents.ms.close()}return n}return!1}},{key:"_addNotification",value:function(e){var t=this._currentId;return this._notifications[t]=e,this._currentId++,t}},{key:"_removeNotification",value:function(e){var t=!1;return this._notifications.hasOwnProperty(e)&&(delete this._notifications[e],t=!0),t}},{key:"_prepareNotification",value:function(e,t){var n,i=this;return n={get:function(){return i._notifications[e]},close:function(){i._closeNotification(e)}},t.timeout&&setTimeout((function(){n.close()}),t.timeout),n}},{key:"_serviceWorkerCallback",value:function(e,t,n){var i=this,r=this._addNotification(e[e.length-1]);navigator&&navigator.serviceWorker&&(navigator.serviceWorker.addEventListener("message",(function(e){var t=JSON.parse(e.data);"close"===t.action&&Number.isInteger(t.id)&&i._removeNotification(t.id)})),n(this._prepareNotification(r,t))),n(null)}},{key:"_createCallback",value:function(e,t,n){var i,r=this,o=null;if(t=t||{},i=function(e){r._removeNotification(e),h.isFunction(t.onClose)&&t.onClose.call(r,o)},this._agents.desktop.isSupported())try{o=this._agents.desktop.create(e,t)}catch(i){var s=this._currentId,c=this.config().serviceWorker;this._agents.chrome.isSupported()&&this._agents.chrome.create(s,e,t,c,(function(e){return r._serviceWorkerCallback(e,t,n)}))}else this._agents.webkit.isSupported()?o=this._agents.webkit.create(e,t):this._agents.firefox.isSupported()?this._agents.firefox.create(e,t):this._agents.ms.isSupported()?o=this._agents.ms.create(e,t):(t.title=e,this.config().fallback(t));if(null!==o){var a=this._addNotification(o),l=this._prepareNotification(a,t);h.isFunction(t.onShow)&&o.addEventListener("show",t.onShow),h.isFunction(t.onError)&&o.addEventListener("error",t.onError),h.isFunction(t.onClick)&&o.addEventListener("click",t.onClick),o.addEventListener("close",(function(){i(a)})),o.addEventListener("cancel",(function(){i(a)})),n(l)}n(null)}},{key:"create",value:function(t,n){var i,r=this;if(!h.isString(t))throw new Error(e.errors.invalid_title);return i=this.Permission.has()?function(e,i){try{r._createCallback(t,n,e)}catch(e){i(e)}}:function(i,o){r.Permission.request().then((function(){r._createCallback(t,n,i)})).catch((function(){o(e.errors.permission_denied)}))},new Promise(i)}},{key:"count",value:function(){var e,t=0;for(e in this._notifications)this._notifications.hasOwnProperty(e)&&t++;return t}},{key:"close",value:function(e){var t;for(t in this._notifications)if(this._notifications.hasOwnProperty(t)&&this._notifications[t].tag===e)return this._closeNotification(t)}},{key:"clear",value:function(){var e,t=!0;for(e in this._notifications)this._notifications.hasOwnProperty(e)&&(t=t&&this._closeNotification(e));return t}},{key:"supported",value:function(){var e=!1;for(var t in this._agents)this._agents.hasOwnProperty(t)&&(e=e||this._agents[t].isSupported());return e}},{key:"config",value:function(e){return(void 0!==e||null!==e&&h.isObject(e))&&h.objectMerge(this._configuration,e),this._configuration}},{key:"extend",value:function(t){var n,i={}.hasOwnProperty;if(!i.call(t,"plugin"))throw new Error(e.errors.invalid_plugin);for(var r in i.call(t,"config")&&h.isObject(t.config)&&null!==t.config&&this.config(t.config),n=new(0,t.plugin)(this.config()))i.call(n,r)&&h.isFunction(n[r])&&(this[r]=n[r])}}]),t}())("undefined"!=typeof window?window:n.g)}()}}]);